function asyncRequest(n){if(n){var t=$(n.getAttribute("data-ajax-loading"));$.ajax({type:"post",url:n.getAttribute("action")||undefined,data:$(n).serializeArray(),beforeSend:function(){t&&t.show()},complete:function(){t&&t.hide()},success:function(t,i,r){asyncOnSuccess(n,t,r.getResponseHeader("Content-Type")||"text/html")},error:function(){console.error("post comment error.")}})}}function asyncOnSuccess(n,t){if($(n).find("[type=submit]").removeAttr("disabled"),t.parentId&&$("#comment-"+t.parentId).find("#comment-respond").remove(),!t.result){t.message&&_alert({text:t.message,icon:"error"});return}t.commentId&&(_alert({text:"Submited",icon:"success"}),$.get(t.url,function(n){var i=t.parentId;i===null?$(".comment-list > ul").append(n):$(n).prependTo($("#comment-"+i).find(" > ul"));initCommentForm()}))}function initCommentForm(){$("#comment-respond").find("textarea").val("");$("#comment-respond").find("[name=CaptchaCode]").val("")}function moveCommentForm(n){var t,i;$("#comment-respond").hide();t=$("#comment-"+n);t.find($("#comment-respond")).size()>0&&t.find($("#comment-respond")).remove();$($("#comment-respond").prop("outerHTML")).show().insertAfter(t.find(">.comment-body"));i=t.find("#commentForm");i.find("input[type=hidden][name=ParentId]").val(n);i.find(".cancel").show();$.validator.unobtrusive.parse(i)}function canelCommentForm(n){$(n).closest("#comment-respond").remove()}function showCommentForm(){$("#comment-respond").show();$("html,body").animate({scrollTop:$("#comment-respond").offset().top},"fast")}$(document).on("submit","form[id=commentForm]",function(n){n.preventDefault();$(this).find("[type=submit]").attr("disabled","disabled");asyncRequest(this)});